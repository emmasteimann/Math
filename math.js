!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).math=n()}(this,(function(){"use strict";function t(n){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function n(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],e=!0,i=!1,o=void 0;try{for(var u,c=t[Symbol.iterator]();!(e=(u=c.next()).done)&&(r.push(u.value),!n||r.length!==n);e=!0);}catch(t){i=!0,o=t}finally{try{e||null==c.return||c.return()}finally{if(i)throw o}}return r}(t,n)||e(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||e(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,n){if(t){if("string"==typeof t)return i(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,n):void 0}}function i(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}var o=function(n){switch(n.constructor.name){case"vector":case"matrix":case"segment":case"ray":case"line":case"circle":case"ellipse":case"rect":case"polygon":case"junction":return n.constructor.name}if("object"===t(n)){if(null!=n.radius)return"circle";if(null!=n.width)return"rect";if(null!=n.x||"number"==typeof n[0])return"vector";if(null!=n[0]&&n[0].length&&("number"==typeof n[0].x||"number"==typeof n[0][0]))return"segment";if(null!=n.vector&&null!=n.origin)return"line"}},u=function(t,n){return n.length===t?n:Array(t).fill(0).map((function(t,r){return n[r]?n[r]:t}))},c=function(t,n){var r=t.length>n.length?t.length:n.length;return[t,n].map((function(t){return u(r,t)}))},a=function(t){var n="".concat(t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return n?Math.max(0,(n[1]?n[1].length:0)-(n[2]?+n[2]:0)):0},f=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof t)return t;var r=parseFloat(t.toFixed(n));return a(r)===Math.min(n,a(t))?t:r},s=function(t){return null!=t&&"function"==typeof t[Symbol.iterator]},l=function t(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return s(arguments[0])&&"string"!=typeof arguments[0]?t.apply(void 0,r(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(n){return s(n)?r(t(n)):n}))}},h=function t(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return s(arguments[0])&&"string"!=typeof arguments[0]?t.apply(void 0,r(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(n){return s(n)?r(t(n)):n})).reduce((function(t,n){return t.concat(n)}),[])}},p=Object.freeze({__proto__:null,resize:u,resize_up:c,resize_down:function(t,n){var r=t.length>n.length?n.length:t.length;return[t,n].map((function(t){return u(r,t)}))},clean_number:f,semi_flatten_arrays:l,flatten_arrays:h}),v=180/Math.PI,g=Math.PI/180,d=2*Math.PI,y=1e-6,m=Object.freeze({__proto__:null,R2D:v,D2R:g,TWO_PI:d,EPSILON:y}),_=function(){return!0},M=function(t){return t*t},b=function(t,n){return t+(n||0)},x=function(t){return void 0!==t},w=function(t){return Math.atan2(t[1],t[0])},j=function(t){return[Math.cos(t),Math.sin(t)]},A=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y;return t>-n},P=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y;return t>n},k=_,O=_,S=A,z=P,I=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y;return t>-n&&t<1+n},q=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y;return t>n&&t<1-n},E=function(t){return t<-y?0:t},N=function(t){return t<-y?0:t>1.000001?1:t},G=Object.freeze({__proto__:null,fn_true:_,fn_square:M,fn_add:b,fn_not_undefined:x,fn_vec2_angle:w,fn_to_vec2:j,include:A,exclude:P,include_l:k,exclude_l:O,include_r:S,exclude_r:z,include_s:I,exclude_s:q,line_limiter:function(t){return t},ray_limiter:E,segment_limiter:N}),F=Object.create(null),L=[1,0,0,1],T=L.concat(0,0),R=function(t){return t[0]*t[3]-t[1]*t[2]},Z=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.cos(t),e=Math.sin(t);return[r,e,-e,r,n[0],n[1]]},D=Object.freeze({__proto__:null,identity2x2:L,identity2x3:T,multiply_matrix2_vector2:function(t,n){return[t[0]*n[0]+t[2]*n[1]+t[4],t[1]*n[0]+t[3]*n[1]+t[5]]},multiply_matrix2_line2:function(t,n,r){return{vector:[t[0]*n[0]+t[2]*n[1],t[1]*n[0]+t[3]*n[1]],origin:[t[0]*r[0]+t[2]*r[1]+t[4],t[1]*r[0]+t[3]*r[1]+t[5]]}},multiply_matrices2:function(t,n){return[t[0]*n[0]+t[2]*n[1],t[1]*n[0]+t[3]*n[1],t[0]*n[2]+t[2]*n[3],t[1]*n[2]+t[3]*n[3],t[0]*n[4]+t[2]*n[5]+t[4],t[1]*n[4]+t[3]*n[5]+t[5]]},determinant2:R,invert_matrix2:function(t){var n=R(t);if(!(Math.abs(n)<1e-6||isNaN(n))&&isFinite(t[4])&&isFinite(t[5]))return[t[3]/n,-t[1]/n,-t[2]/n,t[0]/n,(t[2]*t[5]-t[3]*t[4])/n,(t[1]*t[4]-t[0]*t[5])/n]},make_matrix2_translate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return L.concat(t,n)},make_matrix2_scale:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[t,0,0,n,t*-r[0]+r[0],n*-r[1]+r[1]]},make_matrix2_rotate:Z,make_matrix2_reflect:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.atan2(t[1],t[0]),e=Math.cos(r),i=Math.sin(r),o=Math.cos(-r),u=Math.sin(-r),c=e*o+i*u,a=e*-u+i*o,f=i*o+-e*u,s=i*-u+-e*o,l=n[0]+c*-n[0]+-n[1]*f,h=n[1]+a*-n[0]+-n[1]*s;return[c,a,f,s,l,h]}}),C=function(t){return Math.sqrt(t.map(M).reduce(b,0))},J=function(t){return t.map(M).reduce(b,0)},X=function(t){var n=C(t);return 0===n?t:t.map((function(t){return t/n}))},Y=function(t,n){return t.map((function(t){return t*n}))},$=function(t,n){return t.map((function(t,r){return t+(n[r]||0)}))},B=function(t,n){return t.map((function(t,r){return t-(n[r]||0)}))},H=function(t,n){return t.map((function(r,e){return t[e]*n[e]})).reduce(b,0)},U=function(t,n){return t.map((function(t,r){return(t+n[r])/2}))},V=function(){var t=arguments;if(0===arguments.length)return[];var n=arguments[0].length>0?arguments[0].length:0,r=Array(n).fill(0);return Array.from(arguments).forEach((function(t){return r.forEach((function(n,e){r[e]+=t[e]||0}))})),r.map((function(n){return n/t.length}))},W=function(t,n,r){var e=1-r;return t.map((function(t,i){return t*e+(n[i]||0)*r}))},K=function(t,n){return t[0]*n[1]-t[1]*n[0]},Q=function(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]},tt=function(t,n){var r=t[0]-n[0],e=t[1]-n[1];return Math.sqrt(r*r+e*e)},nt=function(t,n){return Math.sqrt(t.map((function(r,e){return Math.pow(t[e]-n[e],2)})).reduce((function(t,n){return t+n}),0))},rt=function(t){return t.map((function(t){return-t}))},et=function(t){return[-t[1],t[0]]},it=function(t){return[t[1],-t[0]]},ot=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y;return Math.abs(t.reduce(b,0))<n},ut=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y;return 1-Math.abs(H(X(t),X(n)))<r},ct=Object.freeze({__proto__:null,magnitude:C,mag_squared:J,normalize:X,scale:Y,add:$,subtract:B,dot:H,midpoint:U,average:V,lerp:W,cross2:K,cross3:Q,distance2:tt,distance3:function(t,n){var r=t[0]-n[0],e=t[1]-n[1],i=t[2]-n[2];return Math.sqrt(r*r+e*e+i*i)},distance:nt,flip:rt,rotate90:et,rotate270:it,degenerate:ot,parallel:ut}),at=Object.freeze([1,0,0,0,1,0,0,0,1]),ft=Object.freeze(at.concat(0,0,0)),st=function(t){return ft.map((function(n,r){return Math.abs(n-t[r])<y})).reduce((function(t,n){return t&&n}),!0)},lt=function(t,n){return[t[0]*n[0]+t[3]*n[1]+t[6]*n[2]+t[9],t[1]*n[0]+t[4]*n[1]+t[7]*n[2]+t[10],t[2]*n[0]+t[5]*n[1]+t[8]*n[2]+t[11]]},ht=function(t,n,r){return{vector:[t[0]*n[0]+t[3]*n[1]+t[6]*n[2],t[1]*n[0]+t[4]*n[1]+t[7]*n[2],t[2]*n[0]+t[5]*n[1]+t[8]*n[2]],origin:[t[0]*r[0]+t[3]*r[1]+t[6]*r[2]+t[9],t[1]*r[0]+t[4]*r[1]+t[7]*r[2]+t[10],t[2]*r[0]+t[5]*r[1]+t[8]*r[2]+t[11]]}},pt=function(t,n){return[t[0]*n[0]+t[3]*n[1]+t[6]*n[2],t[1]*n[0]+t[4]*n[1]+t[7]*n[2],t[2]*n[0]+t[5]*n[1]+t[8]*n[2],t[0]*n[3]+t[3]*n[4]+t[6]*n[5],t[1]*n[3]+t[4]*n[4]+t[7]*n[5],t[2]*n[3]+t[5]*n[4]+t[8]*n[5],t[0]*n[6]+t[3]*n[7]+t[6]*n[8],t[1]*n[6]+t[4]*n[7]+t[7]*n[8],t[2]*n[6]+t[5]*n[7]+t[8]*n[8],t[0]*n[9]+t[3]*n[10]+t[6]*n[11]+t[9],t[1]*n[9]+t[4]*n[10]+t[7]*n[11]+t[10],t[2]*n[9]+t[5]*n[10]+t[8]*n[11]+t[11]]},vt=function(t){return t[0]*t[4]*t[8]-t[0]*t[7]*t[5]-t[3]*t[1]*t[8]+t[3]*t[7]*t[2]+t[6]*t[1]*t[5]-t[6]*t[4]*t[2]},gt=function(t){var n=vt(t);if(!(Math.abs(n)<1e-6||isNaN(n))&&isFinite(t[9])&&isFinite(t[10])&&isFinite(t[11])){var r=[t[4]*t[8]-t[7]*t[5],-t[1]*t[8]+t[7]*t[2],t[1]*t[5]-t[4]*t[2],-t[3]*t[8]+t[6]*t[5],t[0]*t[8]-t[6]*t[2],-t[0]*t[5]+t[3]*t[2],t[3]*t[7]-t[6]*t[4],-t[0]*t[7]+t[6]*t[1],t[0]*t[4]-t[3]*t[1],-t[3]*t[7]*t[11]+t[3]*t[8]*t[10]+t[6]*t[4]*t[11]-t[6]*t[5]*t[10]-t[9]*t[4]*t[8]+t[9]*t[5]*t[7],t[0]*t[7]*t[11]-t[0]*t[8]*t[10]-t[6]*t[1]*t[11]+t[6]*t[2]*t[10]+t[9]*t[1]*t[8]-t[9]*t[2]*t[7],-t[0]*t[4]*t[11]+t[0]*t[5]*t[10]+t[3]*t[1]*t[11]-t[3]*t[2]*t[10]-t[9]*t[1]*t[5]+t[9]*t[2]*t[4]],e=1/n;return r.map((function(t){return t*e}))}},dt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return at.concat(t,n,r)},yt=function(t,n,r,e,i){var o=at.concat([0,1,2].map((function(t){return n[t]||0}))),u=Math.cos(t),c=Math.sin(t);return o[3*r+r]=u,o[3*r+e]=(i?1:-1)*c,o[3*e+r]=(i?-1:1)*c,o[3*e+e]=u,o},mt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return yt(t,n,1,2,!0)},_t=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return yt(t,n,0,2,!1)},Mt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return yt(t,n,0,1,!0)},bt=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],i=u(3,X(r)),o=[0,1,2].map((function(t){return e[t]||0})),c=n(i,3),a=c[0],f=c[1],s=c[2],l=Math.cos(t),h=Math.sin(t),p=Math.sqrt(i[1]*i[1]+i[2]*i[2]),v=Math.abs(p)<1e-6?0:f/p,g=Math.abs(p)<1e-6?1:s/p,d=at.concat(-o[0],-o[1],-o[2]),y=at.concat(o[0],o[1],o[2]),m=[1,0,0,0,g,v,0,-v,g,0,0,0],_=[1,0,0,0,g,-v,0,v,g,0,0,0],M=[p,0,a,0,1,0,-a,0,p,0,0,0],b=[p,0,-a,0,1,0,a,0,p,0,0,0],x=[l,h,0,-h,l,0,0,0,1,0,0,0];return pt(y,pt(_,pt(b,pt(x,pt(M,pt(m,d))))))},xt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[t,0,0,0,t,0,0,0,t,t*-n[0]+n[0],t*-n[1]+n[1],t*-n[2]+n[2]]},wt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.atan2(t[1],t[0]),e=Math.cos(r),i=Math.sin(r),o=Math.cos(-r),u=Math.sin(-r),c=e*o+i*u,a=e*-u+i*o,f=i*o+-e*u,s=i*-u+-e*o,l=n[0]+c*-n[0]+-n[1]*f,h=n[1]+a*-n[0]+-n[1]*s;return[c,a,0,f,s,0,0,0,1,l,h,0]},jt=Object.freeze({__proto__:null,identity3x3:at,identity3x4:ft,is_identity3x4:st,multiply_matrix3_vector3:lt,multiply_matrix3_line3:ht,multiply_matrices3:pt,determinant3:vt,invert_matrix3:gt,make_matrix3_translate:dt,make_matrix3_rotateX:mt,make_matrix3_rotateY:_t,make_matrix3_rotateZ:Mt,make_matrix3_rotate:bt,make_matrix3_scale:xt,make_matrix3_reflectZ:wt}),At=function(t,n){return{vector:t||[],origin:n||[]}},Pt=function(){if(arguments[0]instanceof F.vector)return arguments[0];var n=h(arguments);return n.length>0&&"object"===t(n[0])&&null!==n[0]&&!isNaN(n[0].x)&&(n=["x","y","z"].map((function(t){return n[0][t]})).filter(x)),n.filter((function(t){return"number"==typeof t}))},kt=function(){return l(arguments).map((function(t){return Pt(t)}))},Ot=function(){if(arguments[0]instanceof F.segment)return arguments[0];var t=l(arguments);return 4===t.length?[[t[0],t[1]],[t[2],t[3]]]:kt(t)},St=function(){var t=l(arguments);return 0===t.length?At([],[]):t[0]instanceof F.line||t[0]instanceof F.ray||t[0]instanceof F.segment?t[0]:t[0].constructor===Object?At(t[0].vector||[],t[0].origin||[]):"number"==typeof t[0]?At(Pt(t)):At.apply(void 0,r(t.map((function(t){return Pt(t)}))))},zt=St,It=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:t,y:n,width:r,height:e}},qt=function(){if(arguments[0]instanceof F.rect)return arguments[0];var n=h(arguments);if(n.length>0&&"object"===t(n[0])&&null!==n[0]&&!isNaN(n[0].width))return It.apply(void 0,r(["x","y","width","height"].map((function(t){return n[0][t]})).filter(x)));var e=n.filter((function(t){return"number"==typeof t})),i=e.length<4?[,,].concat(r(e)):e;return It.apply(void 0,r(i))},Et=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length,r=new Array(n>1?n-1:0),e=1;e<n;e++)r[e-1]=arguments[e];return{radius:t,origin:[].concat(r)}},Nt=function(){if(arguments[0]instanceof F.circle)return arguments[0];var t=kt(arguments),n=h(arguments).filter((function(t){return"number"==typeof t}));if(2===arguments.length){if(1===t[1].length)return Et.apply(void 0,[t[1][0]].concat(r(t[0])));if(1===t[0].length)return Et.apply(void 0,[t[0][0]].concat(r(t[1])));if(t[0].length>1&&t[1].length>1)return Et.apply(void 0,[tt.apply(void 0,r(t))].concat(r(t[0])))}else switch(n.length){case 0:return Et(1,0,0,0);case 1:return Et(n[0],0,0,0);default:return Et.apply(void 0,[n.pop()].concat(r(n)))}return Et(1,0,0,0)},Gt=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(t){return delete Gt[2][t]}));var Ft=function(t){return Gt[t<8?0:t<13?1:2]},Lt=function(){var t=h(arguments),n=r(ft);return Ft(t.length).forEach((function(r,e){null!=t[e]&&(n[r]=t[e])})),n},Tt=Object.freeze({__proto__:null,get_vector:Pt,get_vector_of_vectors:kt,get_segment:Ot,get_line:St,get_ray:zt,get_rect_params:It,get_rect:qt,get_circle:Nt,get_matrix_3x4:Lt}),Rt=function(t,n){return t===n},Zt=function(t,n){return Math.abs(t-n)<y},Dt=function(t,n){return Array.from(Array(t.length-1)).map((function(r,e){return n(t[0],t[e+1])})).reduce((function(t,n){return t&&n}),!0)},Ct=function(t,n){return Math.abs(t[0]-n[0])<y&&Math.abs(t[1]-n[1])<y},Jt=function(){var t=Array.from(arguments),n=t.map((function(t){return t.length})).reduce((function(t,n){return t>n?t:n})),r=t.map((function(t){return u(n,t)}));return Array.from(Array(arguments.length-1)).map((function(t,n){return r[0].map((function(t,e){return Math.abs(r[0][e]-r[n+1][e])<y})).reduce((function(t,n){return t&&n}),!0)})).reduce((function(t,n){return t&&n}),!0)},Xt=Object.freeze({__proto__:null,equivalent_vector2:Ct,equivalent_numbers:function t(){return 0!==arguments.length&&(1===arguments.length&&void 0!==arguments[0]?t.apply(void 0,r(arguments[0])):Dt(arguments,Zt))},equivalent_vectors:Jt,equivalent:function(){var n=l.apply(void 0,arguments);if(n.length<1)return!1;var e=t(n[0]);if("undefined"===e)return!1;switch(e){case"number":return Dt(n,Zt);case"boolean":case"string":return Dt(n,Rt);case"object":return n[0].constructor===Array?Jt.apply(void 0,r(n)):Dt(n,(function(t,n){return JSON.stringify(t)===JSON.stringify(n)}));default:return}}}),Yt=function(t,n){return t.map((function(t){return{point:t,d:t[0]*n[0]+t[1]*n[1]}})).sort((function(t,n){return t.d-n.d})).map((function(t){return t.point}))},$t=Object.freeze({__proto__:null,sort_points_along_vector2:Yt}),Bt=function(t,n,r){for(var e,i=n.map((function(n,e){return{o:n,i:e,d:r(t,n)}})),o=1/0,u=0;u<i.length;u+=1)i[u].d<o&&(e=u,o=i[u].d);return e},Ht=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y;n=u(t.length,n),r=u(t.length,r);var o=J(t),c=B(r,n),a=H(t,c),f=a/o,s=e(f,i);return $(n,Y(t,s))},Ut=function(t,n){var r=t.map((function(t,n,r){return B(r[(n+1)%r.length],t)}));return t.map((function(t,e){return Ht(r[e],t,n,N)})).map((function(t,r){return{point:t,i:r,distance:nt(t,n)}})).sort((function(t,n){return t.distance-n.distance})).shift()},Vt=function(t,n,r){return $(n,Y(X(B(r,n)),t))},Wt=Object.freeze({__proto__:null,smallest_comparison_search:Bt,nearest_point2:function(t,n){var r=Bt(t,n,tt);return void 0===r?void 0:n[r]},nearest_point:function(t,n){var r=Bt(t,n,nt);return void 0===r?void 0:n[r]},nearest_point_on_line:Ht,nearest_point_on_polygon:Ut,nearest_point_on_circle:Vt,nearest_point_on_ellipse:function(){return!1}}),Kt=function(t,n){for(;t<0;)t+=d;for(;n<0;)n+=d;for(;t>d;)t-=d;for(;n>d;)n-=d;var r=n-t;return r>=0?r:d-(t-n)},Qt=function(t,n){var r=n[0]*t[0]+n[1]*t[1],e=n[0]*t[1]-n[1]*t[0],i=Math.atan2(e,r);return i<0&&(i+=d),i},tn=function(t,n){var r=t[0]*n[0]+t[1]*n[1],e=t[0]*n[1]-t[1]*n[0],i=Math.atan2(e,r);return i<0&&(i+=d),i},nn=function(t,n){return j(w(t)-Qt(t,n)/2)},rn=function(t,n){return j(w(t)+tn(t,n)/2)},en=function(t,n,e,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y,u=K(t,e),c=H(t,e),a=u>-o?[rn(t,e)]:[nn(t,e)];a[1]=u>-o?et(a[0]):it(a[0]);var f=(i[0]-n[0])*e[1]-e[0]*(i[1]-n[1]),s=f/u,l=[t,e].map((function(t){return X(t)})),h=Math.abs(K.apply(void 0,r(l)))<o,p=h?U(n,i):[n[0]+t[0]*s,n[1]+t[1]*s],v=a.map((function(t){return{vector:t,origin:p}}));return h&&delete v[c>-o?1:0],v},on=function(){var t=h(arguments),n=t.map((function(t,n){return n})).sort((function(n,r){return t[n]-t[r]}));return n.slice(n.indexOf(0),n.length).concat(n.slice(0,n.indexOf(0)))},un=function(){var t=h(arguments),n=on(t).map((function(n){return t[n]}));return n.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return Kt(t[0],t[1])}))},cn=function(t,n,r){var e=Kt(n,r)/t;return Array.from(Array(t-1)).map((function(t,r){return n+e*(r+1)}))},an=Object.freeze({__proto__:null,is_counter_clockwise_between:function(t,n,r){for(;r<n;)r+=d;for(;t>n;)t-=d;for(;t<n;)t+=d;return t<r},clockwise_angle_radians:function(t,n){for(;t<0;)t+=d;for(;n<0;)n+=d;for(;t>d;)t-=d;for(;n>d;)n-=d;var r=t-n;return r>=0?r:d-(n-t)},counter_clockwise_angle_radians:Kt,clockwise_angle2:Qt,counter_clockwise_angle2:tn,clockwise_bisect2:nn,counter_clockwise_bisect2:rn,bisect_lines2:en,counter_clockwise_order_radians:on,counter_clockwise_order2:function(){return on(kt(arguments).map(w))},counter_clockwise_sectors_radians:un,counter_clockwise_sectors2:function(){return un(kt(arguments).map(w))},counter_clockwise_subsect_radians:cn,counter_clockwise_subsect2:function(t,n,r){var e=Math.atan2(n[1],n[0]),i=Math.atan2(r[1],r[0]);return cn(t,e,i).map(j)}}),fn=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y,o=B(r,n),u=J(t),c=Math.sqrt(u);if(c<i)return!1;var a=K(o,t.map((function(t){return t/c}))),f=H(o,t)/u;return Math.abs(a)<i&&e(f,i/c)},sn=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:O,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:O,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:y,c=K(X(t),X(r));if(!(Math.abs(c)<u)){var a=K(t,r),f=-a,s=[e[0]-n[0],e[1]-n[1]],l=[-s[0],-s[1]],h=K(s,r)/a,p=K(l,t)/f;return i(h,u/C(t))&&o(p,u/C(r))?$(n,Y(t,h)):void 0}},ln=function(t,n,r){var e=n[0]-t[0],i=n[1]-t[1],o=r[0]-t[0],u=r[1]-t[1],c=e*(t[0]+n[0])+i*(t[1]+n[1]),a=o*(t[0]+r[0])+u*(t[1]+r[1]),f=2*(e*(r[1]-n[1])-i*(r[0]-n[0]));if(Math.abs(f)<y){var s=Math.min(t[0],n[0],r[0]),l=Math.min(t[1],n[1],r[1]),h=.5*(Math.max(t[0],n[0],r[0])-s),p=.5*(Math.max(t[1],n[1],r[1])-l);return{origin:[s+h,l+p],radius:Math.sqrt(h*h+p*p)}}var v=[(u*c-i*a)/f,(e*a-o*c)/f],g=v[0]-t[0],d=v[1]-t[1];return{origin:v,radius:Math.sqrt(g*g+d*d)}},hn=function(t){return.5*t.map((function(t,n,r){var e=r[(n+1)%r.length];return t[0]*e[1]-e[0]*t[1]})).reduce(b,0)},pn=function(t){var n=1/(6*hn(t));return t.map((function(t,n,r){var e=r[(n+1)%r.length],i=t[0]*e[1]-e[0]*t[1];return[(t[0]+e[0])*i,(t[1]+e[1])*i]})).reduce((function(t,n){return[t[0]+n[0],t[1]+n[1]]}),[0,0]).map((function(t){return t*n}))},vn=function(t){var n=Array(t[0].length).fill(1/0),r=Array(t[0].length).fill(-1/0);t.forEach((function(t){return t.forEach((function(t,e){t<n[e]&&(n[e]=t),t>r[e]&&(r[e]=t)}))}));var e=r.map((function(t,r){return t-n[r]}));return It(n[0],n[1],e[0],e[1])},gn=function(t){return Array.from(Array(Math.floor(t))).map((function(n,r){return d*(r/t)}))},dn=function(t,n){return t.map((function(t){return[n*Math.cos(t),n*Math.sin(t)]})).map((function(t){return t.map((function(t){return f(t,14)}))}))},yn=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return dn(gn(t),n)},mn=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=Math.PI/t,e=gn(t).map((function(t){return t+r}));return dn(e,n)},_n=function(t,n,r){var e=t.map((function(t,e){return{point:fn(n,r,t,k)?t:null,at_index:e}})).filter((function(t){return null!=t.point})),i=t.map((function(t,e,i){return{point:sn(n,r,B(t,i[(e+1)%i.length]),i[(e+1)%i.length],O,q),at_index:e}})).filter((function(t){return null!=t.point}));if(2==i.length){var o=i.slice().sort((function(t,n){return t.at_index-n.at_index})),u=t.slice(o[1].at_index+1).concat(t.slice(0,o[0].at_index+1));u.push(o[0].point),u.push(o[1].point);var c=t.slice(o[0].at_index+1,o[1].at_index+1);return c.push(o[1].point),c.push(o[0].point),[u,c]}if(1==i.length&&1==e.length){e[0].type="v",i[0].type="e";var a=e.concat(i).sort((function(t,n){return t.at_index-n.at_index})),f=t.slice(a[1].at_index+1).concat(t.slice(0,a[0].at_index+1));"e"===a[0].type&&f.push(a[0].point),f.push(a[1].point);var s=t.slice(a[0].at_index+1,a[1].at_index+1);return"e"===a[1].type&&s.push(a[1].point),s.push(a[0].point),[f,s]}if(2==e.length){var l=e.slice().sort((function(t,n){return t.at_index-n.at_index}));return[t.slice(l[1].at_index).concat(t.slice(0,l[0].at_index+1)),t.slice(l[0].at_index,l[1].at_index+1)]}return[t.slice()]},Mn=function(n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y,e=1e4,i=n.slice().sort((function(t,n){return Math.abs(t[1]-n[1])<r?t[0]-n[0]:t[1]-n[1]})),o=[];o.push(i[0]);var u=0,c=0,a=function(){c+=1;var t=o.length-1,n=i.filter((function(n){return!(Math.abs(n[0]-o[t][0])<r&&Math.abs(n[1]-o[t][1])<r)})).map((function(n){for(var r=Math.atan2(o[t][1]-n[1],o[t][0]-n[0]);r<u;)r+=2*Math.PI;return{node:n,angle:r,distance:void 0}})).sort((function(t,n){return t.angle<n.angle?-1:t.angle>n.angle?1:0}));if(0===n.length)return{v:void 0};var e=n[0];if(n=n.filter((function(t){return Math.abs(e.angle-t.angle)<r})).map((function(n){var r=Math.sqrt(Math.pow(o[t][0]-n.node[0],2)+Math.pow(o[t][1]-n.node[1],2));return n.distance=r,n})).sort((function(t,n){return t.distance<n.distance?1:t.distance>n.distance?-1:0})),o.filter((function(t){return t===n[0].node})).length>0)return{v:o};o.push(n[0].node),u=Math.atan2(o[t][1]-n[0].node[1],o[t][0]-n[0].node[0])};do{var f=a();if("object"===t(f))return f.v}while(c<e)},bn=function t(n,r,e){var i=n.map((function(t,n){return{vector:e[n],origin:t}})).map((function(t,n,r){return sn(t.vector,t.origin,r[(n+1)%r.length].vector,r[(n+1)%r.length].origin,z,z)})),o=r.map((function(t,n){return Ht(t.vector,t.origin,i[n],(function(t){return t}))}));if(3===n.length)return n.map((function(t){return{type:"skeleton",points:[t,i[0]]}})).concat([{type:"perpendicular",points:[o[0],i[0]]}]);var u=i.map((function(t,n){return nt(t,o[n])})),c=0;u.forEach((function(t,n){t<u[c]&&(c=n)}));var a=[{type:"skeleton",points:[n[c],i[c]]},{type:"skeleton",points:[n[(c+1)%n.length],i[c]]},{type:"perpendicular",points:[o[c],i[c]]}],f=nn(rt(r[(c+r.length-1)%r.length].vector),r[(c+1)%r.length].vector),s=c===n.length-1;return n.splice(c,2,i[c]),r.splice(c,1),e.splice(c,2,f),s&&(n.splice(0,1),e.splice(0,1),r.push(r.shift())),a.concat(t(n,r,e))},xn=function(t){var n=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return{vector:B(t[1],t[0]),origin:t[0]}})),e=t.map((function(t,n,r){return[(n-1+r.length)%r.length,n,(n+1)%r.length].map((function(t){return r[t]}))})).map((function(t){return[B(t[0],t[1]),B(t[2],t[1])]})).map((function(t){return nn.apply(void 0,r(t))}));return bn(t,n,e)},wn=Object.freeze({__proto__:null,circumcircle:ln,signed_area:hn,centroid:pn,enclosing_rectangle:vn,make_regular_polygon:yn,make_regular_polygon_side_aligned:mn,make_regular_polygon_inradius:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return yn(t,n/Math.cos(Math.PI/t))},make_regular_polygon_inradius_side_aligned:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return mn(t,n/Math.cos(Math.PI/t))},make_regular_polygon_side_length:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return yn(t,n/2/Math.sin(Math.PI/t))},make_regular_polygon_side_length_side_aligned:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return mn(t,n/2/Math.sin(Math.PI/t))},split_convex_polygon:_n,convex_hull:Mn,straight_skeleton:xn}),jn=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:k,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:y,u=Math.pow(r[0],2)+Math.pow(r[1],2),c=Math.sqrt(u),a=0===c?r:r.map((function(t){return t/c})),f=et(a),s=B(e,n),l=K(s,a);if(!(Math.abs(l)>t+o)){var h=Math.sqrt(Math.pow(t,2)-Math.pow(l,2)),p=function(t,r){return n[r]-f[r]*l+a[r]*t},v=Math.abs(t-Math.abs(l))<o?[h].map((function(t){return[t,t].map(p)})):[-h,h].map((function(t){return[t,t].map(p)})),g=v.map((function(t){return t.map((function(t,n){return t-e[n]}))})).map((function(t){return t[0]*r[0]+r[1]*t[1]})).map((function(t){return t/u}));return v.filter((function(t,n){return i(g[n],o)}))}},An=function(t,n){var r=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)),e=[-t[1],t[0]],i=(n[0]*e[0]+n[1]*e[1])/r;return i<0?{u:[-e[0]/r,-e[1]/r],d:-i}:{u:[e[0]/r,e[1]/r],d:i}},Pn=function(t){var n=t.u,r=t.d;return{vector:[n[1],-n[0]],origin:[r*n[0],r*n[1]]}},kn=function(t){return t<0?-Math.pow(-t,1/3):Math.pow(t,1/3)},On=Object.freeze({__proto__:null,axiom1:function(t,n){return F.line(X(B.apply(void 0,r(c(n,t)))),t)},axiom2:function(t,n){return F.line(X(et(B.apply(void 0,r(c(n,t))))),U(t,n))},axiom3:function(t,n,r,e){return en(t,n,r,e).map(F.line)},axiom4:function(t,n){return F.line(et(X(t)),n)},axiom5:function(t,n,e,i){return(jn(nt(e,i),e,t,n,k)||[]).map((function(t){return F.line(X(et(B.apply(void 0,r(c(t,i))))),U(i,t))}))},axiom6:function(t,n,r,e,i,o){var u=An(t,n),c=An(r,e);if(Math.abs(1-H(u.u,i)/u.d)<.02)return[];var a=[-u.u[1],u.u[0]],f=[i[0]+u.d*u.u[0]-2*o[0],i[1]+u.d*u.u[1]-2*o[1]],s=[u.d*u.u[0]-i[0],u.d*u.u[1]-i[1]],l=H(o,c.u)-c.d,h=2*H(s,a),p=H(s,s),v=H($(f,s),a),g=H(f,s),d=H(a,c.u),m=H(s,c.u),_=d,M=l+v*d+m,b=l*h+g*d+v*m,x=l*p+g*m,w=function(t){return[u.d*u.u[0]+t*a[0],u.d*u.u[1]+t*a[1]]},j=0;Math.abs(b)>y&&(j=1),Math.abs(M)>y&&(j=2),Math.abs(_)>y&&(j=3);var A=[];switch(j){case 1:A.push(w(-x/b));break;case 2:var P=Math.pow(b,2)-4*M*x;if(P<-y)break;var k=-b/(2*M);if(P<y){A.push(w(k));break}var O=Math.sqrt(P)/(2*M);A.push(w(k+O),w(k-O));break;case 3:var S=M/_,z=b/_,I=x/_,q=(3*z-Math.pow(S,2))/9,E=(9*S*z-27*I-2*Math.pow(S,3))/54,N=Math.pow(q,3)+Math.pow(E,2),G=-S/3;if(N>0){var L=Math.sqrt(N),T=kn(E+L),R=kn(E-L);A.push(w(G+T+R));break}if(Math.abs(N)<y){var Z=Math.pow(E,1/3);if(isNaN(Z))break;A.push(w(G+2*Z),w(G-Z));break}var D=Math.sqrt(-N),C=Math.atan2(D,E)/3,J=Math.pow(Math.pow(E,2)-N,1/6),Y=J*Math.cos(C),V=J*Math.sin(C);A.push(w(G+2*Y),w(G-Y-Math.sqrt(3)*V),w(G-Y+Math.sqrt(3)*V))}return A.map((function(t){return X(B(t,i))})).map((function(t,n){return{u:t,d:H(t,U(A[n],i))}})).map(Pn).map(F.line)},axiom7:function(t,n,e,i){var o=sn(t,n,e,i,k,k);return void 0===o?void 0:F.line(X(et(B.apply(void 0,r(c(o,i))))),U(i,o))}}),Sn=function(t){return t>=1?0:t<=-1?Math.PI:Math.acos(t)},zn=function(t,n,r){var e=n[0]-t[0],i=n[1]-t[1],o=e*Math.cos(r)+i*Math.sin(r),u=i*Math.cos(r)-e*Math.sin(r);return[t[0]+o,t[1]+u]},In=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y,o=t<r?t:r,u=t<r?r:t,c=t<r?n:e,a=t<r?e:n,f=[c[0]-a[0],c[1]-a[1]],s=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2));if(!(s<i)){var l=f.map((function(t,n){return t/s*u+a[n]}));if(Math.abs(u+o-s)<i||Math.abs(u-(o+s))<i)return[l];if(!(s+o<u||u+o<s)){var h=Sn((o*o-s*s-u*u)/(-2*s*u)),p=zn(a,l,+h),v=zn(a,l,-h);return[p,v]}}},qn=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:P;return t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return K(X(B(t[1],t[0])),B(n,t[0]))})).map((function(t){return r(t)})).map((function(t,n,r){return t===r[0]})).reduce((function(t,n){return t&&n}),!0)},En=function(t){for(var n=1;n<t.length;n+=1)if(!Ct(t[0],t[n]))return[t[0],t[n]]},Nn=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:k,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:y,u=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return sn(B(t[1],t[0]),t[0],n,r,e,i,o)})).filter((function(t){return void 0!==t}));switch(u.length){case 0:return;case 1:return[u];default:return En(u)||[u[0]]}},Gn=function(t,n,e){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:k,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:y,a=Nn(t,n,e,o,u,c);switch(u){case O:i=k;break;case z:i=S;break;case q:i=I;break;default:return a}var f=Nn(t,n,e,I,i,c);if(void 0!==f){var s=En(f);if(void 0===s)switch(u){case O:return;case z:return qn(t,e,P,c)?f:void 0;case q:return qn(t,$(e,n),P,c)||qn(t,e,P,c)?f:void 0}return qn(t,U.apply(void 0,r(s)),P,c)?s:a}},Fn=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y;return Gn(t,n,r,q,O,e)},Ln=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y;return Gn(t,n,r,q,z,e)},Tn=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y;return Gn(t,B(r,n),n,q,q,e)},Rn=Object.freeze({__proto__:null,convex_poly_line_inclusive:function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y;return Nn(t,n,r,I,k,e)},convex_poly_ray_inclusive:function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y;return Nn(t,n,r,I,S,e)},convex_poly_segment_inclusive:function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y;return Nn(t,B(r,n),n,I,I,e)},convex_poly_line_exclusive:Fn,convex_poly_ray_exclusive:Ln,convex_poly_segment_exclusive:Tn}),Zn={polygon:function(t){return[t]},rect:function(t){return[t]},circle:function(t){return[t.radius,t.origin]},line:function(t){return[t.vector,t.origin]},ray:function(t){return[t.vector,t.origin]},segment:function(t){return[B(t[1],t[0]),t[0]]}},Dn={polygon:{line:function(t,n){return Fn.apply(void 0,r(t).concat(r(n)))},ray:function(t,n){return Ln.apply(void 0,r(t).concat(r(n)))},segment:function(t,n){return Tn.apply(void 0,r(t).concat(r(n)))}},circle:{circle:function(t,n){return In.apply(void 0,r(t).concat(r(n)))},line:function(t,n){return jn.apply(void 0,r(t).concat(r(n),[O]))},ray:function(t,n){return jn.apply(void 0,r(t).concat(r(n),[z]))},segment:function(t,n){return jn.apply(void 0,r(t).concat(r(n),[q]))}},line:{polygon:function(t,n){return Fn.apply(void 0,r(n).concat(r(t)))},circle:function(t,n){return jn.apply(void 0,r(n).concat(r(t),[O]))},line:function(t,n,e){return sn.apply(void 0,r(t).concat(r(n),[O,O,e]))},ray:function(t,n,e){return sn.apply(void 0,r(t).concat(r(n),[O,z,e]))},segment:function(t,n,e){return sn.apply(void 0,r(t).concat(r(n),[O,q,e]))}},ray:{polygon:function(t,n){return Ln.apply(void 0,r(n).concat(r(t)))},circle:function(t,n){return jn.apply(void 0,r(n).concat(r(t),[z]))},line:function(t,n,e){return sn.apply(void 0,r(n).concat(r(t),[O,z,e]))},ray:function(t,n,e){return sn.apply(void 0,r(t).concat(r(n),[z,z,e]))},segment:function(t,n,e){return sn.apply(void 0,r(t).concat(r(n),[z,q,e]))}},segment:{polygon:function(t,n){return Tn.apply(void 0,r(n).concat(r(t)))},circle:function(t,n){return jn.apply(void 0,r(n).concat(r(t),[q]))},line:function(t,n,e){return sn.apply(void 0,r(n).concat(r(t),[O,q,e]))},ray:function(t,n,e){return sn.apply(void 0,r(n).concat(r(t),[z,q,e]))},segment:function(t,n,e){return sn.apply(void 0,r(t).concat(r(n),[q,q,e]))}}},Cn={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment"},Jn=function(t,n){for(var r,e=o(t),i=o(n),u=Cn[e],c=Cn[i],a=Zn[e](t),f=Zn[i](n),s=arguments.length,l=new Array(s>2?s-2:0),h=2;h<s;h++)l[h-2]=arguments[h];return(r=Dn[u])[c].apply(r,[a,f].concat(l))},Xn=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:O,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:O,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:y,c=K(t,r),a=-c;if(Math.abs(c)<u)return fn(t,n,e,i,u)||fn(rt(t),$(n,t),e,i,u)||fn(r,e,n,o,u)||fn(rt(r),$(e,r),n,o,u);var f=[e[0]-n[0],e[1]-n[1]],s=[-f[0],-f[1]],l=K(f,r)/c,h=K(s,t)/a;return i(l,u/C(t))&&o(h,u/C(r))},Yn=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:q,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:P,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y;if(qn(t,n[0],e,i))return!0;if(qn(n,t[0],e,i))return!0;for(var o=t.map((function(t,n,r){return[B(r[(n+1)%r.length],t),t]})),u=n.map((function(t,n,r){return[B(r[(n+1)%r.length],t),t]})),c=0;c<o.length;c+=1)for(var a=0;a<u.length;a+=1)if(Xn(o[c][0],o[c][1],u[a][0],u[a][1],r,r,i))return!0;return!1},$n=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y;return sn(t,n,B(e,r),r,k,I,i)},Bn=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y;return sn(t,n,B(e,r),r,O,q,i)},Hn=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y;return sn(t,n,B(e,r),r,S,I,i)},Un=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y;return sn(t,n,B(e,r),r,z,q,i)},Vn=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y;return sn(B(n,t),t,B(e,r),r,I,I,i)},Wn=function(t){for(var n=1;n<t.length;n+=1)if(!Ct(t[0],t[n]))return[t[0],t[n]]},Kn=function(t){for(var n=[],r=0;r<t.length;r+=1){for(var e=!1,i=0;i<n.length;i+=1)Ct(t[r],n[i])&&(e=!0);e||n.push(t[r])}return n},Qn=function(t,n,e){var i=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return B.apply(void 0,r(t))}));return i.map((function(t,r){return ut(t,n)?r:void 0})).filter(x).map((function(n){return fn(i[n],t[n],e)})).reduce((function(t,n){return t||n}),!1)},tr=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y;return n.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(n){return t(r,e,n[0],n[1],i)})).filter(x)},nr=function(t,n,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y,o=(tr(Bn,t,n,e,i),tr($n,t,n,e,i));if(void 0!==o){var u=Wn(o);if(void 0!==u)return qn(t,U.apply(void 0,r(u)),P,i)?u:void 0}},rr=function(t,n,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y,o=(tr(Un,t,n,e,i),tr(Hn,t,n,e,i));if(void 0!==o){var u=Wn(o);return void 0===u?qn(t,e,P,i)?[e,o[0]]:void 0:qn(t,U.apply(void 0,r(u)),P,i)?u:void 0}},er=function(t,n,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y,o=[n,e],u=o.map((function(n){return qn(t,n,A,i)}));if(!0===u[0]&&!0===u[1])return[r(n),r(e)];var c=tr(Vn,t,n,e,i),a=Kn(c);if(2===a.length)return a;if(a.length>2){var f=Yt(a,B(e,n));return[f[0],f[f.length-1]]}if(c.length>0){var s=o.map((function(n){return qn(t,n,P,i)}));if(!0===s[0])return[r(n),c[0]];if(!0===s[1])return[r(e),c[0]]}},ir=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y,i=B(r,n);if(!Qn(t,i,n))return er(t,n,r,e)},or=Object.freeze({__proto__:null,clip_line_in_convex_poly_inclusive:function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y,i=tr($n,t,n,r,e);switch(i.length){case 0:case 1:return;default:return Wn(i)}},clip_line_in_convex_poly_exclusive:nr,clip_ray_in_convex_poly_inclusive:function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y,i=tr(Hn,t,n,r,e);if(0!==i.length){qn(t,r,A);return Wn(i)||[r,i[0]]}},clip_ray_in_convex_poly_exclusive:rr,clip_segment_in_convex_poly_inclusive:function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y;return er(t,n,r,e)},clip_segment_in_convex_poly_exclusive:ir}),ur={preserve:{magnitude:function(){return C(this)},isEquivalent:function(){return Jt(this,Pt(arguments))},isParallel:function(){return ut.apply(void 0,r(c(this,Pt(arguments))))},dot:function(){return H.apply(void 0,r(c(this,Pt(arguments))))},distanceTo:function(){return nt.apply(void 0,r(c(this,Pt(arguments))))}},vector:{copy:function(){return r(this)},normalize:function(){return X(this)},scale:function(){return Y(this,arguments[0])},flip:function(){return rt(this)},rotate90:function(){return et(this)},rotate270:function(){return it(this)},cross:function(){return Q(u(3,this),u(3,Pt(arguments)))},transform:function(){return lt(Lt(arguments),u(3,this))},add:function(){return $(this,u(this.length,Pt(arguments)))},subtract:function(){return B(this,u(this.length,Pt(arguments)))},rotateZ:function(t,n){return lt(Lt(Z(t,n)),u(3,this))},lerp:function(t,n){return W(this,u(this.length,Pt(t)),n)},midpoint:function(){return U.apply(void 0,r(c(this,Pt(arguments))))},bisect:function(){return rn(this,Pt(arguments))}}},cr={};Object.keys(ur.preserve).forEach((function(t){cr[t]=ur.preserve[t]})),Object.keys(ur.vector).forEach((function(t){cr[t]=function(){return F.vector.apply(F,r(ur.vector[t].apply(this,arguments)))}}));var ar={fromAngle:function(t){return F.vector(Math.cos(t),Math.sin(t))},fromAngleDegrees:function(t){return F.vector.fromAngle(t*g)}},fr={vector:{P:Array.prototype,A:function(){var t=this;Pt(arguments).forEach((function(n){return t.push(n)}))},G:{x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]}},M:cr,S:ar}},sr={};sr.prototype=Object.create(Object.prototype),sr.prototype.constructor=sr,sr.prototype.isParallel=function(){var t=c(this.vector,St.apply(void 0,arguments).vector);return ut.apply(void 0,r(t))},sr.prototype.isCollinear=function(){var t=St(arguments);return fn(this.vector,this.origin,t.origin)&&ut.apply(void 0,r(c(this.vector,t.vector)))},sr.prototype.isDegenerate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y;return ot(this.vector,t)},sr.prototype.reflectionMatrix=function(){return F.matrix(wt(this.vector,this.origin))},sr.prototype.nearestPoint=function(){var t=Pt(arguments);return F.vector(Ht(this.vector,this.origin,t,this.clip_function))},sr.prototype.transform=function(){var t=this.dimension,n=ht(Lt(arguments),u(3,this.vector),u(3,this.origin));return this.constructor(u(t,n.vector),u(t,n.origin))},sr.prototype.translate=function(){var t=$.apply(void 0,r(c(this.origin,Pt(arguments))));return this.constructor(this.vector,t)},sr.prototype.intersect=function(t){return Jn(this,t)},sr.prototype.bisect=function(){var t=St(arguments);return en(this.vector,this.origin,t.vector,t.origin)},Object.defineProperty(sr.prototype,"dimension",{get:function(){return[this.vector,this.origin].map((function(t){return t.length})).reduce((function(t,n){return Math.max(t,n)}),0)}});var lr={fromPoints:function(){var t=kt(arguments);return this.constructor({vector:B(t[1],t[0]),origin:t[0]})},fromAngle:function(){var t=arguments[0]||0;return this.constructor({vector:[Math.cos(t),Math.sin(t)],origin:[0,0]})},perpendicularBisector:function(){var t=kt(arguments);return this.constructor({vector:et(B(t[1],t[0])),origin:V(t[0],t[1])})}},hr={line:{P:sr.prototype,A:function(){var t=St.apply(void 0,arguments);this.vector=F.vector(t.vector),this.origin=F.vector(u(this.vector.length,t.origin))},G:{length:function(){return 1/0}},M:{clip_function:function(t){return t},comp_function:O,svgPath:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,n=$(this.origin,Y(this.vector,-t/2)),r=Y(this.vector,t);return"M".concat(n[0]," ").concat(n[1],"l").concat(r[0]," ").concat(r[1])}},S:lr}},pr={ray:{P:sr.prototype,A:function(){var t=St.apply(void 0,arguments);this.vector=F.vector(t.vector),this.origin=F.vector(u(this.vector.length,t.origin))},G:{length:function(){return 1/0}},M:{flip:function(){return F.ray(rt(this.vector),this.origin)},scale:function(t){return F.ray(this.vector.scale(t),this.origin)},normalize:function(){return F.ray(this.vector.normalize(),this.origin)},clip_function:E,comp_function:z,svgPath:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,n=this.vector.scale(t);return"M".concat(this.origin[0]," ").concat(this.origin[1],"l").concat(n[0]," ").concat(n[1])}},S:lr}},vr={segment:{P:sr.prototype,A:function(){var t=Ot.apply(void 0,arguments);this.points=[F.vector(t[0]),F.vector(t[1])],this.vector=this.points[1].subtract(this.points[0]),this.origin=this.points[0]},G:{0:function(){return this.points[0]},1:function(){return this.points[1]},length:function(){return this.vector.magnitude()}},M:{clip_function:N,comp_function:q,transform:function(){for(var t=this.points[0].length,n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];var i=Lt(r),o=this.points.map((function(t){return u(3,t)})).map((function(t){return lt(i,t)})).map((function(n){return u(t,n)}));return F.segment(o)},translate:function(){var t=Pt(arguments),n=this.points.map((function(n){return $.apply(void 0,r(c(n,t)))}));return F.segment(n)},midpoint:function(){return F.vector(V(this.points[0],this.points[1]))},svgPath:function(){var t=this.points.map((function(t){return"".concat(t[0]," ").concat(t[1])}));return["M","L"].map((function(n,r){return"".concat(n).concat(t[r])})).join("")}},S:{fromPoints:function(){return this.constructor.apply(this,arguments)}}}},gr=function(t,n,r,e,i,o){var u=Math.cos(i),c=Math.sin(i),a=Math.cos(o),f=Math.sin(o);return[t+u*r*a+-c*e*f,n+c*r*a+u*e*f]},dr=function(t,n,r,e,i,o,u){var c=o;if(c<0&&!isNaN(c))for(;c<0;)c+=2*Math.PI;var a=u>2*Math.PI?2*Math.PI:u,f=gr(t,n,r,e,i,c),s=gr(t,n,r,e,i,c+a/2),l=gr(t,n,r,e,i,c+a),h=a/2>Math.PI?1:0,p=a/2>0?1:0;return{x1:f[0],y1:f[1],x2:s[0],y2:s[1],x3:l[0],y3:l[1],fa:h,fs:p}},yr=function(t){return f(t,4)},mr=function(t,n,r,e,i,o,u){return"A".concat(yr(t)," ").concat(yr(n)," ").concat(yr(r)," ").concat(yr(e)," ").concat(yr(i)," ").concat(yr(o)," ").concat(yr(u))},_r={circle:{A:function(){var t=Nt.apply(void 0,arguments);this.radius=t.radius,this.origin=F.vector.apply(F,r(t.origin))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]},z:function(){return this.origin[2]}},M:{nearestPoint:function(){return F.vector(Vt(this.radius,this.origin,Pt(arguments)))},intersect:function(t){return Jn(this,t)},svgPath:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,r=dr(this.origin[0],this.origin[1],this.radius,this.radius,0,t,n),e=mr(this.radius,this.radius,0,r.fa,r.fs,r.x2,r.y2),i=mr(this.radius,this.radius,0,r.fa,r.fs,r.x3,r.y3);return"M".concat(r.x1," ").concat(r.y1).concat(e).concat(i)},points:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(n)).map((function(t,r){return 2*Math.PI/n*r})).map((function(n){return[t.origin[0]+t.radius*Math.cos(n),t.origin[1]+t.radius*Math.sin(n)]}))},polygon:function(){return F.polygon(this.points(arguments[0]))},segments:function(){var t=this.points(arguments[0]);return t.map((function(n,r){var e=(r+1)%t.length;return[n,t[e]]}))}},S:{fromPoints:function(){if(3===arguments.length){var t=ln.apply(void 0,arguments);return this.constructor(t.radius,t.origin)}return this.constructor.apply(this,arguments)},fromThreePoints:function(){var t=ln.apply(void 0,arguments);return this.constructor(t.radius,t.origin)}}}},Mr=function(t,n,r,e){var i=n>r,o=i?Math.pow(n,2)-Math.pow(r,2):Math.pow(r,2)-Math.pow(n,2),u=Math.sqrt(o),c=i?Math.cos(e):Math.sin(e),a=i?Math.sin(e):Math.cos(e);return[F.vector(t[0]+u*c,t[1]+u*a),F.vector(t[0]-u*c,t[1]-u*a)]},br={ellipse:{A:function(){var t=h(arguments).filter((function(t){return!isNaN(t)})),n=u(5,t);this.rx=n[0],this.ry=n[1],this.origin=F.vector(n[2],n[3]),this.spin=n[4],this.foci=Mr(this.origin,this.rx,this.ry,this.spin)},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{svgPath:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,r=dr(this.origin[0],this.origin[1],this.rx,this.ry,this.spin,t,n),e=mr(this.rx,this.ry,this.spin/Math.PI*180,r.fa,r.fs,r.x2,r.y2),i=mr(this.rx,this.ry,this.spin/Math.PI*180,r.fa,r.fs,r.x3,r.y3);return"M".concat(r.x1," ").concat(r.y1).concat(e).concat(i)},points:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(n)).map((function(t,r){return 2*Math.PI/n*r})).map((function(n){return gr(t.origin.x,t.origin.y,t.rx,t.ry,t.spin,n)}))},polygon:function(){return F.polygon(this.points(arguments[0]))},segments:function(){var t=this.points(arguments[0]);return t.map((function(n,r){var e=(r+1)%t.length;return[n,t[e]]}))}},S:{}}},xr=function(t){return void 0===t?void 0:F.segment(t)},wr={area:function(){return hn(this)},centroid:function(){return F.vector(pn(this))},enclosingRectangle:function(){return F.rect(vn(this))},contains:function(){return qn(this,Pt(arguments))},straightSkeleton:function(){return xn(this)},scale:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pn(this),r=this.map((function(t){return[0,1].map((function(r,e){return t[e]-n[e]}))})).map((function(r){return r.map((function(e,i){return n[i]+r[i]*t}))}));return this.constructor.fromPoints(r)},rotate:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pn(this),r=this.map((function(r){var e=[r[0]-n[0],r[1]-n[1]],i=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),o=Math.atan2(e[1],e[0]);return[n[0]+Math.cos(o+t)*i,n[1]+Math.sin(o+t)*i]}));return F.polygon(r)},translate:function(){var t=Pt.apply(void 0,arguments),n=this.map((function(n){return n.map((function(n,r){return n+t[r]}))}));return this.constructor.fromPoints(n)},transform:function(){var t=Lt.apply(void 0,arguments),n=this.map((function(n){return lt(t,u(3,n))}));return F.polygon(n)},nearest:function(){var t=Pt.apply(void 0,arguments),n=Ut(this,t);return void 0===n?void 0:Object.assign(n,{edge:this.sides[n.i]})},overlaps:function(){var t=l(arguments);return Yn(this,t)},split:function(){var t=St.apply(void 0,arguments),n=_n;return n(this,t.vector,t.origin).map((function(t){return F.polygon(t)}))},intersectLine:function(){var t=St.apply(void 0,arguments);return Fn(this,t.vector,t.origin)},intersectRay:function(){var t=St.apply(void 0,arguments);return Ln(this,t.vector,t.origin)},intersectSegment:function(){var t=Ot.apply(void 0,arguments);return Tn(this,t[0],t[1])},clipLine:function(){var t=St.apply(void 0,arguments),n=nr(this,t.vector,t.origin);return xr(n)},clipRay:function(){var t=St.apply(void 0,arguments),n=rr(this,t.vector,t.origin);return xr(n)},clipSegment:function(){var t=Ot.apply(void 0,arguments),n=ir(this,t[0],t[1]);return xr(n)},clip:function(t){switch(o(t)){case"segment":return this.clipSegment(t);case"ray":return this.clipRay(t);case"line":return this.clipLine(t);default:return}},svgPath:function(){var t=Array(this.length).fill("L");return t[0]="M","".concat(this.map((function(n,r){return"".concat(t[r]).concat(n[0]," ").concat(n[1])})).join(""),"z")},intersect:function(t){return Jn(this,t)}},jr={};jr.prototype=Object.create(Array.prototype),jr.prototype.constructor=jr,Object.keys(wr).forEach((function(t){jr.prototype[t]=wr[t]}));var Ar=function(t){return[[t.x,t.y],[t.x+t.width,t.y],[t.x+t.width,t.y+t.height],[t.x,t.y+t.height]]},Pr={rect:{P:jr.prototype,A:function(){var t=qt.apply(void 0,arguments);this.width=t.width,this.height=t.height,this.origin=F.vector(t.x,t.y),this.push.apply(this,r(Ar(this)))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]},center:function(){return F.vector(this.origin[0]+this.width/2,this.origin[1]+this.height/2)}},M:{area:function(){return this.width*this.height},segments:function(){return[[[(t=this).x,t.y],[t.x+t.width,t.y]],[[t.x+t.width,t.y],[t.x+t.width,t.y+t.height]],[[t.x+t.width,t.y+t.height],[t.x,t.y+t.height]],[[t.x,t.y+t.height],[t.x,t.y]]];var t},svgPath:function(){return"M".concat(this.origin.join(" "),"h").concat(this.width,"v").concat(this.height,"h").concat(-this.width,"Z")}},S:{fromPoints:function(){return F.rect(vn(kt(arguments)))}}}},kr={polygon:{P:jr.prototype,A:function(){this.push.apply(this,r(l(arguments))),this.sides=this.map((function(t,n,r){return[t,r[(n+1)%r.length]]})),this.vectors=this.sides.map((function(t){return B(t[1],t[0])}))},G:{isConvex:function(){return!0},points:function(){return this}},M:{segments:function(){return this.sides},straightSkeleton:function(){return xn(this)}},S:{fromPoints:function(){return this.constructor.apply(this,arguments)},regularPolygon:function(){return this.constructor(yn.apply(void 0,arguments))},convexHull:function(){return this.constructor(Mn.apply(void 0,arguments))}}}},Or=function(t,n){for(var r=0;r<12;r+=1)t[r]=n[r];return t},Sr={matrix:{P:Array.prototype,A:function(){var t=this;Lt(arguments).forEach((function(n){return t.push(n)}))},G:{},M:{copy:function(){return F.matrix.apply(F,r(Array.from(this)))},set:function(){return Or(this,Lt(arguments))},isIdentity:function(){return st(this)},multiply:function(t){return Or(this,pt(this,t))},determinant:function(){return vt(this)},inverse:function(){return Or(this,gt(this))},translate:function(t,n,r){return Or(this,pt(this,dt(t,n,r)))},rotateX:function(t){return Or(this,pt(this,mt(t)))},rotateY:function(t){return Or(this,pt(this,_t(t)))},rotateZ:function(t){return Or(this,pt(this,Mt(t)))},rotate:function(t,n,r){var e=bt(t,n,r);return Or(this,pt(this,e))},scale:function(t){return Or(this,pt(this,xt(t)))},reflectZ:function(t,n){var r=wt(t,n);return Or(this,pt(this,r))},transform:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return F.vector(lt(this,u(3,Pt(n))))},transformVector:function(t){return F.vector(lt(this,u(3,Pt(t))))},transformLine:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=St(n);return F.line(ht(this,e.vector,e.origin))}},S:{}}},zr=Object.assign({},fr,hr,pr,vr,_r,br,Pr,kr,Sr),Ir=function(t,n){var r=Object.create(zr[t].proto);return zr[t].A.apply(r,n),r};Object.assign(F,{vector:function(){return Ir("vector",arguments)},circle:function(){return Ir("circle",arguments)},ellipse:function(){return Ir("ellipse",arguments)},rect:function(){return Ir("rect",arguments)},polygon:function(){return Ir("polygon",arguments)},line:function(){return Ir("line",arguments)},ray:function(){return Ir("ray",arguments)},segment:function(){return Ir("segment",arguments)},matrix:function(){return Ir("matrix",arguments)},junction:function(){return Ir("junction",arguments)}}),Object.keys(zr).forEach((function(t){var n={};n.prototype=null!=zr[t].P?Object.create(zr[t].P):Object.create(Object.prototype),n.prototype.constructor=n,F[t].prototype=n.prototype,F[t].prototype.constructor=F[t],Object.keys(zr[t].G).forEach((function(r){return Object.defineProperty(n.prototype,r,{get:zr[t].G[r]})})),Object.keys(zr[t].M).forEach((function(r){return Object.defineProperty(n.prototype,r,{value:zr[t].M[r]})})),Object.keys(zr[t].S).forEach((function(n){return Object.defineProperty(F[t],n,{value:zr[t].S[n].bind(F[t].prototype)})})),zr[t].proto=n.prototype}));var qr=F;return qr.core=Object.assign(Object.create(null),m,p,Tt,G,ct,Xt,$t,wn,an,D,jt,Wt,On,Rn,or,{enclose_convex_polygons_inclusive:function(t,n){var r=t.map((function(t){return qn(n,t,A)})).reduce((function(t,n){return t||n}),!1),e=n.map((function(t){return qn(n,t,A)})).reduce((function(t,n){return t&&n}),!0);return!r&&e},intersect_circle_circle:In,intersect_circle_line:jn,intersect_line_line:sn,overlap_convex_polygons:Yn,overlap_convex_polygon_point:qn,overlap_line_line:Xn,overlap_line_point:fn}),qr.typeof=o,qr.intersect=Jn,qr}));
